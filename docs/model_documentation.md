# EduPredict — Model Documentation

> Last updated: 2026  
> Maintained by: ML Engineers Team

---

## 1. Problem Statement

EduPredict forecasts national student enrollment totals over 5, 10, and 15-year horizons. The model supports three scenarios (baseline, optimistic, pessimistic) to capture uncertainty in future conditions.

**Target Variable:** `enrollment_total` — total national student enrollment per year.

---

## 2. Model Architecture

### 2.1 Model Type

| Property | Value |
|---|---|
| Model class | Gradient Boosted Trees (XGBoost) |
| Task | Supervised regression (tabular time-series) |
| Prediction type | Point forecast + confidence interval |
| Baseline comparison | Linear Regression (benchmark) |

### 2.2 Why XGBoost?

XGBoost was selected after benchmarking against Linear Regression and Random Forest because:
- It handles non-linear relationships between GDP, population, and enrollment.
- It is robust to moderate missing data and outliers.
- It produces explainable feature importances.
- It generalizes well across diverse country profiles.

---

## 3. Features

### 3.1 Input Features (at prediction time)

| Feature | Type | Description |
|---|---|---|
| `year_index` | numeric | Years since 1970 |
| `enrollment_lag1` | numeric | Enrollment 1 year prior |
| `enrollment_lag3` | numeric | Enrollment 3 years prior |
| `enrollment_rolling3` | numeric | 3-year rolling mean |
| `gdp_per_capita_log` | numeric | Log-transformed GDP per capita |
| `edu_expenditure_lag1` | numeric | Education expenditure (lagged 1yr) |
| `population_school_age` | numeric | School-age population |
| `region_encoded` | categorical | Encoded geographic region |

### 3.2 Feature Importance (approximate, v1.0)

| Rank | Feature | Importance |
|---|---|---|
| 1 | `enrollment_lag1` | 0.41 |
| 2 | `enrollment_rolling3` | 0.22 |
| 3 | `population_school_age` | 0.15 |
| 4 | `gdp_per_capita_log` | 0.10 |
| 5 | `year_index` | 0.07 |
| 6 | `edu_expenditure_lag1` | 0.03 |
| 7 | `region_encoded` | 0.02 |

---

## 4. Training

### 4.1 Data Split

| Split | Method | Size |
|---|---|---|
| Training | Years ≤ 2018 | ~75% |
| Validation | Years 2019–2021 | ~15% |
| Test | Years 2022–2024 | ~10% |

Time-based splitting is used (no random shuffle) to prevent data leakage.

### 4.2 Hyperparameters

| Parameter | Value |
|---|---|
| `n_estimators` | 400 |
| `max_depth` | 5 |
| `learning_rate` | 0.05 |
| `subsample` | 0.8 |
| `colsample_bytree` | 0.8 |
| `min_child_weight` | 3 |
| `reg_alpha` | 0.1 |
| `reg_lambda` | 1.0 |

Hyperparameters were selected via 5-fold cross-validation on the training set.

---

## 5. Evaluation

### 5.1 Metrics

| Metric | Baseline (Linear Reg.) | EduPredict (XGBoost) |
|---|---|---|
| RMSE | 1,240,000 | 685,000 |
| MAE | 890,000 | 480,000 |
| R² | 0.87 | 0.94 |

All metrics computed on held-out test set (2022–2024).

### 5.2 Evaluation Script

```bash
python src/models/evaluate.py --model models/edupredict_v1.pkl --test data/processed/test.csv
```

---

## 6. Scenario Modeling

Scenarios are generated by adjusting GDP and education expenditure assumptions:

| Scenario | GDP Growth | Edu. Expenditure | Description |
|---|---|---|---|
| Baseline | Historical trend | Constant | Most likely outcome |
| Optimistic | +1.5% per year | +0.5% of GDP | Favorable policy & economic growth |
| Pessimistic | −1.0% per year | −0.3% of GDP | Economic contraction, funding cuts |

Confidence intervals (95%) are estimated using bootstrapped residuals from the validation set.

---

## 7. Inference Pipeline

```
Input: country_code, year, scenario
    ↓
Feature construction (lags, rolling stats, encodings)
    ↓
XGBoost model prediction
    ↓
Scenario multiplier applied
    ↓
Output: predicted_enrollment + lower_bound + upper_bound
```

### Prediction Script

```bash
python src/models/predict.py --country USA --horizon 10 --scenario baseline
```

### API Endpoint

```
POST /predict
Content-Type: application/json

{
  "country_code": "USA",
  "horizon": 10,
  "scenario": "baseline"
}
```

---

## 8. Model Versioning

| Version | Date | Notes |
|---|---|---|
| v1.0 | 2026-02 | Initial training, baseline features |
| v1.1 | 2026-03 | Added rolling features, improved RMSE |
| v1.2 | 2026-04 | Hyperparameter tuning, final evaluation |

Models are saved to `src/models/saved/edupredict_v{version}.pkl`.

---

## 9. Assumptions & Limitations

- Historical enrollment trends are assumed to persist into future periods (structural breaks not modeled).
- Country-level features are assumed to be available at inference time; missing values are imputed using the last known value.
- Scenarios are deterministic adjustments; they do not capture stochastic uncertainty.
- The model does not currently account for conflict, natural disasters, or major policy discontinuities.
- Forecasts beyond 10 years should be interpreted as indicative, not precise.

---

## 10. Replication

To fully retrain the model from scratch:

```bash
# Step 1: Run ETL
python src/etl/pipeline.py

# Step 2: Engineer features
python src/etl/feature_engineering.py

# Step 3: Train
python src/models/train.py

# Step 4: Evaluate
python src/models/evaluate.py

# Step 5: Export forecasts
python src/models/predict_all.py
```

All outputs will be written to `data/processed/`, `data/exports/`, and `src/models/saved/`.
